# Day Two - Kubernetes Manifests

---

In this section we will explore _Kubernetes_ manifests.

---


A _Kubernetes_ manifest is a file, either in `yaml` or `json` format, that describes one or more _Kubernetes_ resources.  Generally,  it is best practice to describe one resource per manifest file.  However, you will often encounter manifest files that define multiple resources.

When we deployed our first application, in section [01-05](../01-getting-started-with-kubernetes/01-05.md), we had a quick look at _Kubernetes_ manifests for `Deployment` and `Service` resources.


A manifest file is constructed of well defined sections.

Lets look at a simple example and break it down.

api
  versioning and groups
name
metadata
  annotations
  labels
spec

Optional NameSpace definition.  But if not defining then the resoucres will be created in either the `default` namespace or the one current set in teh context inside kubeconfig.  We disucss the kubeconfig file later on.



https://kubernetes.io/docs/reference/using-api/api-overview/
https://github.com/kubernetes/community/blob/master/contributors/devel/api_changes.md#alpha-beta-and-stable-versions
https://github.com/kubernetes/community/blob/master/contributors/design-proposals/api-machinery/api-group.md  ???

The core (also called legacy) group, which is at REST path /api/v1 and is not specified as part of the apiVersion field, for example, apiVersion: v1.

The named groups are at REST path /apis/$GROUP_NAME/$VERSION, and use apiVersion: $GROUP_NAME/$VERSION (for example, apiVersion: batch/v1). You can find the full list of supported API groups in Kubernetes API reference.

https://kubernetes.io/docs/reference/#api-reference


The two paths that support extending the API with custom resources are:
CustomResourceDefinition for basic CRUD needs.
aggregator for a full set of Kubernetes API semantics to implement their own apiserver.



Annotation
A key-value pair that is used to attach arbitrary non-identifying metadata to objects. [-]
The metadata in an annotation can be small or large, structured or unstructured, and can include characters not permitted by labels. Clients such as tools and libraries can retrieve this metadata.


Label
Tags objects with identifying attributes that are meaningful and relevant to users. [-]
Labels are key/value pairs that are attached to objects such as Pods . They are used to organize and to select subsets of objects.

Name
A client-provided string that refers to an object in a resource URL, such as /api/v1/pods/some-name. [-]
Only one object of a given kind can have a given name at a time. However, if you delete the object, you can make a new object with the same name.

## kubeconfig






## Scratch

Pod.

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: myapp-pod
  labels:
    app: myapp
spec:
  containers:
  - name: myapp-container
    image: busybox
    command: ['sh', '-c', 'echo Hello Kubernetes! && sleep 3600']
```

Pod with init containers.

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: myapp-pod
  labels:
    app: myapp
spec:
  containers:
  - name: myapp-container
    image: busybox
    command: ['sh', '-c', 'echo The app is running! && sleep 3600']
  initContainers:
  - name: init-myservice
    image: busybox
    command: ['sh', '-c', 'until nslookup myservice; do echo waiting for myservice; sleep 2; done;']
  - name: init-mydb
    image: busybox
    command: ['sh', '-c', 'until nslookup mydb; do echo waiting for mydb; sleep 2; done;']
```


# Next

Let's ....

[Next](02-04.md)